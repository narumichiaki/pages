<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, user-scalable=no">
    <script src="subarutone.js"></script>
    <link rel="stylesheet" href="style.css">
    <title>スバルトーン</title>
</head>
<body>
    <div id="container">
        <div id="left-panel">
            <div id="slider-container">
                <div id="slider">
                    <div id="slider-bar"></div>
                    <div id="overlay">準備中 …</div>
                </div>
            </div>
        </div>
        <div id="right-panel">
            <h1>スバルトーン</h1>
            <div class="mode-switch-container isnotready" id="easy-mode-container">
                <label for="check">　　かんたんモード</label>
                <div class="mode-switch isnotready" id="easy-mode"><input type="checkbox" name="check" /></div>
            </div>
            <div class="mode-switch-container isnotready" id="otamatone-mode-container">
                <label for="check">オタマトーンモード</label>
                <div class="mode-switch isnotready" id="otamatone-mode"><input type="checkbox" name="check" /></div>
            </div>
            <p id="frequency">0 Hz</p>
            <p class="description">マウスカーソルやタッチで右のスライダーを触るとスバルが歌います。</p>
            <p class="attention">スライダーが反応しないときは、オタマトーンモードをON→OFFしてみてください。iOSで起きるバグなのですが直りません……。</p>
            <p class="description">また、<a href="https://www.amazon.co.jp//dp/B07W62Z7M2/" target="_blank" title="Amazon (非アフィリエイトリンク)">オタマトーンneo</a>/<a href="https://www.amazon.co.jp/dp/B01M1OV5KC/" target="_blank" title="Amazon (非アフィリエイトリンク)">techno</a>本体から直接操作し、オタマトーン本体からスバルの声を出すこともできます。オタマトーンneo/technoを付属ケーブルで接続し、オタマトーンモードをONにしてマイクの利用を許可してください。</p>
            <p class="attention">オタマトーンモードは、<strong><a href="https://www.amazon.co.jp//dp/B07W62Z7M2/" target="_blank" title="Amazon (非アフィリエイトリンク)">オタマトーンneo</a>/<a href="https://www.amazon.co.jp/dp/B01M1OV5KC/" target="_blank" title="Amazon (非アフィリエイトリンク)">techno</a>でしか利用できず</strong>、かつ、ステレオミニ四極端子が<strong>CTIA規格に対応している機器</strong>(Apple製品等)との組み合わせでしか利用できません。iPhoneには端子がないため、<strong>四極対応</strong>の変換ケーブルが別途必要です。<br />AndroidやWindows PCでの動作は保証しません。</p>
            <ul id="acknowledgement">
                <li>音源： 大空スバルさま <a href="https://www.youtube.com/live/3LA6t9YHsKw">YouTube</a></li>
                <li>発想： くみゆき進さま <a href="https://www.youtube.com/watch?v=1eFY9CDFBkw">YouTube</a></li>
                <li>オタマトーン： 明和電機さま・株式会社キューブさま <a href="https://otamatone.jp">公式</a></li>
                <li>音声合成ライブラリ： 森勢将雅さま <a href="http://www.isc.meiji.ac.jp/~mmorise/world/index.html">WORLD</a></li>
                <li>作成(連絡先)： narumichiaki <a href="https://x.com/narumichiaki">X</a></li>
            </ul>
            <p id="log">このサイトは、すべての計算処理をあなたが使っているブラウザ上で行うように設計されており、サーバへデータを送信することは一切ありません。オタマトーンモードではマイク入力を介してオタマトーンを使いますが、あなたのプライバシーを侵害することはありません。安心してご利用ください。</p>
        </div>
    </div>
    <script>
        // スバルを起こす
        duck = Subaru.wakeUp();

        // HTMLがすべてロードされ、スバルの準備が完了したらユーザが使えるようにする。
        let isDomLoaded = false;
        let isSubaruReady = false;
        function prepare() {
            if (isDomLoaded && isSubaruReady) {
                View.setEventListeners(duck);
                View.getReadyOverlay();
            }
        }
        // HTMLのロード完了を監視
        document.addEventListener('DOMContentLoaded', () => {
            isDomLoaded = true;
            prepare();
        });
        // スバルの準備完了を監視
        document.addEventListener('EngineReady', () => {
            isSubaruReady = true;
            prepare();
        });
    </script>
</body>
</html>
